<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ssm: ssm-mem.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ssm
   &#160;<span id="projectnumber">0.0.2</span>
   </div>
   <div id="projectbrief">Runtime Library for the Sparse Synchronous Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ssm-mem.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>SSM runtime memory management and allocation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;<a class="el" href="ssm-internal_8h_source.html">ssm-internal.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="ssm_8h_source.html">ssm.h</a>&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for ssm-mem.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="ssm-mem_8c__incl.png" border="0" usemap="#ssm-mem_8c" alt=""/></div>
<map name="ssm-mem_8c" id="ssm-mem_8c">
<area shape="rect" title="SSM runtime memory management and allocation." alt="" coords="241,5,340,32"/>
<area shape="rect" title=" " alt="" coords="37,80,112,107"/>
<area shape="rect" href="ssm-internal_8h.html" title="The internal interface of the SSM runtime." alt="" coords="137,80,253,107"/>
<area shape="rect" href="ssm_8h.html" title="Interface to the SSM runtime." alt="" coords="189,155,251,181"/>
<area shape="rect" title=" " alt="" coords="306,229,377,256"/>
<area shape="rect" title=" " alt="" coords="379,80,445,107"/>
<area shape="rect" title=" " alt="" coords="5,229,88,256"/>
<area shape="rect" title=" " alt="" coords="112,229,187,256"/>
<area shape="rect" title=" " alt="" coords="211,229,282,256"/>
</map>
</div>
</div>
<p><a href="ssm-mem_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionblock.html">block</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">(The beginning of) a block of memory.  <a href="unionblock.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmem__pool.html">mem_pool</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A memory pool, which maintains a free list.  <a href="structmem__pool.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6cf03c7de7cc7f358098c21d5cb280ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#a6cf03c7de7cc7f358098c21d5cb280ac">BLOCKS_PER_PAGE</a>&#160;&#160;&#160;(<a class="el" href="group__mem.html#gab5a6226f024f81622a5ce90dcd9b7388">SSM_MEM_PAGE_SIZE</a> / sizeof(<a class="el" href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">block_t</a>))</td></tr>
<tr class="memdesc:a6cf03c7de7cc7f358098c21d5cb280ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of blocks in each memory page.  <a href="ssm-mem_8c.html#a6cf03c7de7cc7f358098c21d5cb280ac">More...</a><br /></td></tr>
<tr class="separator:a6cf03c7de7cc7f358098c21d5cb280ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f798b3dcc78cc8ef1fe40aff68ccfd8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#a6f798b3dcc78cc8ef1fe40aff68ccfd8">UNINITIALIZED_FREE_BLOCK</a>&#160;&#160;&#160;((<a class="el" href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">block_t</a> *)0x0)</td></tr>
<tr class="memdesc:a6f798b3dcc78cc8ef1fe40aff68ccfd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">A "pointer" that points to the next contiguous block in memory.  <a href="ssm-mem_8c.html#a6f798b3dcc78cc8ef1fe40aff68ccfd8">More...</a><br /></td></tr>
<tr class="separator:a6f798b3dcc78cc8ef1fe40aff68ccfd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8d38e174ca767601ec126ef90cf89ab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#ad8d38e174ca767601ec126ef90cf89ab">END_OF_FREELIST</a>&#160;&#160;&#160;((<a class="el" href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">block_t</a> *)0x42)</td></tr>
<tr class="memdesc:ad8d38e174ca767601ec126ef90cf89ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sentinel value indicating the end of the free list.  <a href="ssm-mem_8c.html#ad8d38e174ca767601ec126ef90cf89ab">More...</a><br /></td></tr>
<tr class="separator:ad8d38e174ca767601ec126ef90cf89ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aeac4cdf7303e3047b0eb7bec7ebb7399"><td class="memItemLeft" align="right" valign="top">typedef union <a class="el" href="unionblock.html">block</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">block_t</a></td></tr>
<tr class="memdesc:aeac4cdf7303e3047b0eb7bec7ebb7399"><td class="mdescLeft">&#160;</td><td class="mdescRight">(The beginning of) a block of memory.  <a href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">More...</a><br /></td></tr>
<tr class="separator:aeac4cdf7303e3047b0eb7bec7ebb7399"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab679b53c418f0fd42b1bb3e0a0fd9dfd"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#ab679b53c418f0fd42b1bb3e0a0fd9dfd">find_pool_size</a> (size_t size)</td></tr>
<tr class="memdesc:ab679b53c418f0fd42b1bb3e0a0fd9dfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the memory pool for some arbitrary size.  <a href="ssm-mem_8c.html#ab679b53c418f0fd42b1bb3e0a0fd9dfd">More...</a><br /></td></tr>
<tr class="separator:ab679b53c418f0fd42b1bb3e0a0fd9dfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9df693157bde17eda351ca1a94eae032"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#a9df693157bde17eda351ca1a94eae032">alloc_pool</a> (size_t p)</td></tr>
<tr class="memdesc:a9df693157bde17eda351ca1a94eae032"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new block for a memory pool.  <a href="ssm-mem_8c.html#a9df693157bde17eda351ca1a94eae032">More...</a><br /></td></tr>
<tr class="separator:a9df693157bde17eda351ca1a94eae032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe56b79f41cfe1522669c35cbc423231"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem.html#gafe56b79f41cfe1522669c35cbc423231">ssm_mem_init</a> (void *(*alloc_page_handler)(void), void *(*alloc_mem_handler)(size_t), void(*free_mem_handler)(void *, size_t))</td></tr>
<tr class="memdesc:gafe56b79f41cfe1522669c35cbc423231"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the underlying allocator system.  <a href="group__mem.html#gafe56b79f41cfe1522669c35cbc423231">More...</a><br /></td></tr>
<tr class="separator:gafe56b79f41cfe1522669c35cbc423231"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1accac4139fc44c56acab9ece5db7f73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem.html#ga1accac4139fc44c56acab9ece5db7f73">ssm_mem_prealloc</a> (size_t size, size_t num_pages)</td></tr>
<tr class="memdesc:ga1accac4139fc44c56acab9ece5db7f73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Preallocate memory pages to ensure capacity in memory pools.  <a href="group__mem.html#ga1accac4139fc44c56acab9ece5db7f73">More...</a><br /></td></tr>
<tr class="separator:ga1accac4139fc44c56acab9ece5db7f73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb146ccc4d7843565c93a22084f6ab1f"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem.html#gaeb146ccc4d7843565c93a22084f6ab1f">ssm_mem_alloc</a> (size_t size)</td></tr>
<tr class="memdesc:gaeb146ccc4d7843565c93a22084f6ab1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a contiguous range of memory.  <a href="group__mem.html#gaeb146ccc4d7843565c93a22084f6ab1f">More...</a><br /></td></tr>
<tr class="separator:gaeb146ccc4d7843565c93a22084f6ab1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3087c5edfa451e28309ea0cb234ad02e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem.html#ga3087c5edfa451e28309ea0cb234ad02e">ssm_mem_free</a> (void *m, size_t size)</td></tr>
<tr class="memdesc:ga3087c5edfa451e28309ea0cb234ad02e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate memory allocated by <a class="el" href="group__mem.html#gaeb146ccc4d7843565c93a22084f6ab1f" title="Allocate a contiguous range of memory.">ssm_mem_alloc()</a>.  <a href="group__mem.html#ga3087c5edfa451e28309ea0cb234ad02e">More...</a><br /></td></tr>
<tr class="separator:ga3087c5edfa451e28309ea0cb234ad02e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f65317cd4db9b3d410b63b112726a5c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#a4f65317cd4db9b3d410b63b112726a5c">drop_children</a> (struct <a class="el" href="structssm__mm.html">ssm_mm</a> *mm)</td></tr>
<tr class="memdesc:a4f65317cd4db9b3d410b63b112726a5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recursively drop all children of a heap object.  <a href="ssm-mem_8c.html#a4f65317cd4db9b3d410b63b112726a5c">More...</a><br /></td></tr>
<tr class="separator:a4f65317cd4db9b3d410b63b112726a5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf01d70767e121a2fb2e766f00603d599"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structssm__object.html">ssm_object</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem.html#gaf01d70767e121a2fb2e766f00603d599">ssm_new</a> (uint8_t val_count, uint8_t tag)</td></tr>
<tr class="memdesc:gaf01d70767e121a2fb2e766f00603d599"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new heap object to store word-size values.  <a href="group__mem.html#gaf01d70767e121a2fb2e766f00603d599">More...</a><br /></td></tr>
<tr class="separator:gaf01d70767e121a2fb2e766f00603d599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa8e3503b367e5ea3248060ce10488916"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem.html#gaa8e3503b367e5ea3248060ce10488916">ssm_dup</a> (struct <a class="el" href="structssm__mm.html">ssm_mm</a> *mm)</td></tr>
<tr class="memdesc:gaa8e3503b367e5ea3248060ce10488916"><td class="mdescLeft">&#160;</td><td class="mdescRight">Duplicate a reference to a heap item, incrementing its ref count.  <a href="group__mem.html#gaa8e3503b367e5ea3248060ce10488916">More...</a><br /></td></tr>
<tr class="separator:gaa8e3503b367e5ea3248060ce10488916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa19e5773ed713940dcc8f61a1dfc8e2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem.html#gaa19e5773ed713940dcc8f61a1dfc8e2f">ssm_drop</a> (struct <a class="el" href="structssm__mm.html">ssm_mm</a> *mm)</td></tr>
<tr class="memdesc:gaa19e5773ed713940dcc8f61a1dfc8e2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drop a reference to a heap item, and free it if necessary.  <a href="group__mem.html#gaa19e5773ed713940dcc8f61a1dfc8e2f">More...</a><br /></td></tr>
<tr class="separator:gaa19e5773ed713940dcc8f61a1dfc8e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab468491385e10631bf4687fa3f005ae5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structssm__mm.html">ssm_mm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem.html#gab468491385e10631bf4687fa3f005ae5">ssm_reuse</a> (struct <a class="el" href="structssm__mm.html">ssm_mm</a> *mm)</td></tr>
<tr class="memdesc:gab468491385e10631bf4687fa3f005ae5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reuse heap-allocated memory.  <a href="group__mem.html#gab468491385e10631bf4687fa3f005ae5">More...</a><br /></td></tr>
<tr class="separator:gab468491385e10631bf4687fa3f005ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a02b28cd24b5aa39cb5824b984cd82987"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structmem__pool.html">mem_pool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#a02b28cd24b5aa39cb5824b984cd82987">mem_pools</a> [<a class="el" href="group__mem.html#ga8404b692c7f1ab6beaf2ebb5614e4790">SSM_MEM_POOL_COUNT</a>]</td></tr>
<tr class="memdesc:a02b28cd24b5aa39cb5824b984cd82987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory pools from <a class="el" href="group__mem.html#ga5514bce5af584559d51b5f75344205ef" title="Block size of the smallest memory pool.">SSM_MEM_POOL_MIN</a> to <a class="el" href="group__mem.html#gafd44b83b7d4fb58e0fccd2380a540a52" title="The size of the largest memory pool.">SSM_MEM_POOL_MAX</a>.  <a href="ssm-mem_8c.html#a02b28cd24b5aa39cb5824b984cd82987">More...</a><br /></td></tr>
<tr class="separator:a02b28cd24b5aa39cb5824b984cd82987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40385bc630b530cbe8cadeff2008421a"><td class="memItemLeft" align="right" valign="top">static void *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#a40385bc630b530cbe8cadeff2008421a">alloc_page</a> )(void)</td></tr>
<tr class="memdesc:a40385bc630b530cbe8cadeff2008421a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Page allocation handler, set by <a class="el" href="group__mem.html#gafe56b79f41cfe1522669c35cbc423231" title="Initializes the underlying allocator system.">ssm_mem_init()</a>.  <a href="ssm-mem_8c.html#a40385bc630b530cbe8cadeff2008421a">More...</a><br /></td></tr>
<tr class="separator:a40385bc630b530cbe8cadeff2008421a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe84928b968b035c36a85decd645d13f"><td class="memItemLeft" align="right" valign="top">static void *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#afe84928b968b035c36a85decd645d13f">alloc_mem</a> )(size_t size)</td></tr>
<tr class="memdesc:afe84928b968b035c36a85decd645d13f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Large memory allocation handler, set by <a class="el" href="group__mem.html#gafe56b79f41cfe1522669c35cbc423231" title="Initializes the underlying allocator system.">ssm_mem_init()</a>.  <a href="ssm-mem_8c.html#afe84928b968b035c36a85decd645d13f">More...</a><br /></td></tr>
<tr class="separator:afe84928b968b035c36a85decd645d13f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e094b32b7178847b7c17a01070f5ea"><td class="memItemLeft" align="right" valign="top">static void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssm-mem_8c.html#ac9e094b32b7178847b7c17a01070f5ea">free_mem</a> )(void *mem, size_t size)</td></tr>
<tr class="memdesc:ac9e094b32b7178847b7c17a01070f5ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Large memory release handler, set by <a class="el" href="group__mem.html#gafe56b79f41cfe1522669c35cbc423231" title="Initializes the underlying allocator system.">ssm_mem_init()</a>.  <a href="ssm-mem_8c.html#ac9e094b32b7178847b7c17a01070f5ea">More...</a><br /></td></tr>
<tr class="separator:ac9e094b32b7178847b7c17a01070f5ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SSM runtime memory management and allocation. </p>
<dl class="section author"><dt>Author</dt><dd>John Hui (j-hui) </dd>
<dd>
Daniel Scanteianu (Scanteianu) </dd></dl>

<p class="definition">Definition in file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6cf03c7de7cc7f358098c21d5cb280ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf03c7de7cc7f358098c21d5cb280ac">&#9670;&nbsp;</a></span>BLOCKS_PER_PAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLOCKS_PER_PAGE&#160;&#160;&#160;(<a class="el" href="group__mem.html#gab5a6226f024f81622a5ce90dcd9b7388">SSM_MEM_PAGE_SIZE</a> / sizeof(<a class="el" href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">block_t</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The number of blocks in each memory page. </p>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00033">33</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<a id="a6f798b3dcc78cc8ef1fe40aff68ccfd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f798b3dcc78cc8ef1fe40aff68ccfd8">&#9670;&nbsp;</a></span>UNINITIALIZED_FREE_BLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UNINITIALIZED_FREE_BLOCK&#160;&#160;&#160;((<a class="el" href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">block_t</a> *)0x0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A "pointer" that points to the next contiguous block in memory. </p>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00036">36</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<a id="ad8d38e174ca767601ec126ef90cf89ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8d38e174ca767601ec126ef90cf89ab">&#9670;&nbsp;</a></span>END_OF_FREELIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define END_OF_FREELIST&#160;&#160;&#160;((<a class="el" href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">block_t</a> *)0x42)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sentinel value indicating the end of the free list. </p>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00039">39</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aeac4cdf7303e3047b0eb7bec7ebb7399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac4cdf7303e3047b0eb7bec7ebb7399">&#9670;&nbsp;</a></span>block_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef union <a class="el" href="unionblock.html">block</a> <a class="el" href="ssm-mem_8c.html#aeac4cdf7303e3047b0eb7bec7ebb7399">block_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(The beginning of) a block of memory. </p>
<p>The size of each block varies depending on which memory pool it resides in. When a block is being used (allocated), <em>block_buf</em> effectively gives a pointer to the beginning that block that can be indexed into.</p>
<p>When a block is not being used, it is maintained in a <em>free list</em>. If it is not at the head of the free list, then it is pointed to by the <em>free_list_next</em> field of some other block_t, while its own <em>free_list_next</em> points to the next block in the free list. To avoid initializing the <em>free_list_next</em> fields of "fresh" blocks, when <em>free_list_next</em> is <a class="el" href="ssm-mem_8c.html#a6f798b3dcc78cc8ef1fe40aff68ccfd8" title="A &quot;pointer&quot; that points to the next contiguous block in memory.">UNINITIALIZED_FREE_BLOCK</a>, the next free block contiguously follows the current block in memory. The last free block points to <a class="el" href="ssm-mem_8c.html#ad8d38e174ca767601ec126ef90cf89ab" title="Sentinel value indicating the end of the free list.">END_OF_FREELIST</a>. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab679b53c418f0fd42b1bb3e0a0fd9dfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab679b53c418f0fd42b1bb3e0a0fd9dfd">&#9670;&nbsp;</a></span>find_pool_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t find_pool_size </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find the memory pool for some arbitrary size. </p>
<p>Tries to find the smallest memory pool that will fit a block of <em>size</em>. Returns <a class="el" href="group__mem.html#ga8404b692c7f1ab6beaf2ebb5614e4790" title="Number of memory pools.">SSM_MEM_POOL_COUNT</a> if no such pool exists, i.e., if <em>size</em> is greater than <a class="el" href="group__mem.html#gafd44b83b7d4fb58e0fccd2380a540a52" title="The size of the largest memory pool.">SSM_MEM_POOL_MAX</a>.</p>
<p>Since <a class="el" href="group__mem.html#ga8404b692c7f1ab6beaf2ebb5614e4790" title="Number of memory pools.">SSM_MEM_POOL_COUNT</a> is a (small) compile-time constant, this linear search is effectively contant time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>the block size whose memory pool we are looking for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>index to the memory pool, or <a class="el" href="group__mem.html#ga8404b692c7f1ab6beaf2ebb5614e4790" title="Number of memory pools.">SSM_MEM_POOL_COUNT</a> otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00074">74</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<a id="a9df693157bde17eda351ca1a94eae032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9df693157bde17eda351ca1a94eae032">&#9670;&nbsp;</a></span>alloc_pool()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void alloc_pool </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate a new block for a memory pool. </p>
<p>Calls <a class="el" href="ssm-mem_8c.html#a40385bc630b530cbe8cadeff2008421a" title="Page allocation handler, set by ssm_mem_init().">alloc_page()</a> to allocate a new zero-initialized page for the memory pool, and adds it to the corresponding memory pool with stack discipline. The last block of the free list is pointed to the old head of the free list.</p>
<p>Constant time (not counting what <a class="el" href="ssm-mem_8c.html#a40385bc630b530cbe8cadeff2008421a" title="Page allocation handler, set by ssm_mem_init().">alloc_page()</a> does).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>the index of the memory pool. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00091">91</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<a id="a4f65317cd4db9b3d410b63b112726a5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f65317cd4db9b3d410b63b112726a5c">&#9670;&nbsp;</a></span>drop_children()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void drop_children </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssm__mm.html">ssm_mm</a> *&#160;</td>
          <td class="paramname"><em>mm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recursively drop all children of a heap object. </p>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00153">153</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a02b28cd24b5aa39cb5824b984cd82987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02b28cd24b5aa39cb5824b984cd82987">&#9670;&nbsp;</a></span>mem_pools</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmem__pool.html">mem_pool</a> mem_pools[<a class="el" href="group__mem.html#ga8404b692c7f1ab6beaf2ebb5614e4790">SSM_MEM_POOL_COUNT</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Memory pools from <a class="el" href="group__mem.html#ga5514bce5af584559d51b5f75344205ef" title="Block size of the smallest memory pool.">SSM_MEM_POOL_MIN</a> to <a class="el" href="group__mem.html#gafd44b83b7d4fb58e0fccd2380a540a52" title="The size of the largest memory pool.">SSM_MEM_POOL_MAX</a>. </p>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00051">51</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<a id="a40385bc630b530cbe8cadeff2008421a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40385bc630b530cbe8cadeff2008421a">&#9670;&nbsp;</a></span>alloc_page</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void*(* alloc_page) (void)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Page allocation handler, set by <a class="el" href="group__mem.html#gafe56b79f41cfe1522669c35cbc423231" title="Initializes the underlying allocator system.">ssm_mem_init()</a>. </p>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00054">54</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<a id="afe84928b968b035c36a85decd645d13f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe84928b968b035c36a85decd645d13f">&#9670;&nbsp;</a></span>alloc_mem</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void*(* alloc_mem) (size_t size)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Large memory allocation handler, set by <a class="el" href="group__mem.html#gafe56b79f41cfe1522669c35cbc423231" title="Initializes the underlying allocator system.">ssm_mem_init()</a>. </p>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00057">57</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
<a id="ac9e094b32b7178847b7c17a01070f5ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9e094b32b7178847b7c17a01070f5ea">&#9670;&nbsp;</a></span>free_mem</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void(* free_mem) (void *mem, size_t size)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Large memory release handler, set by <a class="el" href="group__mem.html#gafe56b79f41cfe1522669c35cbc423231" title="Initializes the underlying allocator system.">ssm_mem_init()</a>. </p>

<p class="definition">Definition at line <a class="el" href="ssm-mem_8c_source.html#l00060">60</a> of file <a class="el" href="ssm-mem_8c_source.html">ssm-mem.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
